<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>管理</title>
    <script type="text/javascript" src="../common/lib/jquery-3.2.1.js"></script>
    <link rel="stylesheet" href="../common/common.css" type="text/css">
    <script type="text/javascript">
        var managerInfo = null;
        $(document).ready(function () {
            managerInfo=getLoginedManager();
            if (managerInfo.type == "ADMIN") {
                $("#adminOptions").show();
            } else {
                $("#adminOptions").hide();
            }
        });

        function getLoginedManager() {
            var managerInfo;
            $.ajax({
                url: "/manage/managerLogin/getLoginedManager",
                data: {},
                async: false,
                success: function (ajaxResult) {
                    if (ajaxResult.success) {
                        if (ajaxResult.managerInfo == null) {
                            alert("未登录，或登录超时，请重新登陆");
                            window.location.href = "login.html";
                        } else {
                            managerInfo = ajaxResult.managerInfo;
                        }
                    } else {
                        alert("失败，原因：" + ajaxResult.message);
                    }
                },
                error: function () {
                    alert("请求服务失败");
                }
            });
            return managerInfo;
        }

        function changeDetailWindowUrl(newUrl) {
            $("#detailWindow").attr("src", newUrl);
        }

    </script>
</head>
<body>
<div>
    <table width="100%" height="1000px">
        <tr>
            <td width="30%" valign="top">
                <table align="right">
                    <tr>
                        <td>
                            <button onclick='changeDetailWindowUrl("appProfileShow.html")'>首页</button>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div id="adminOptions" style="display:none;">
                                <table>
                                    <tr>
                                        <td>
                                            <button onclick='changeDetailWindowUrl("appManage.html")'>项目</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <button onclick='changeDetailWindowUrl("profileManage.html")'>环境</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <button onclick='changeDetailWindowUrl("managerManage.html")'>管理员</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <button onclick='changeDetailWindowUrl("managerAppManage.html")'>管理员与应用关联
                                            </button>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <button onclick='changeDetailWindowUrl("managerInfoModify.html?code="+getUrlParam("code"))'>
                                修改个人信息
                            </button>
                        </td>
                    </tr>
                </table>
            </td>
            <td width="70%">
                <iframe id="detailWindow" src="appProfileShow.html" width="100%" height="100%"></iframe>
            </td>
        </tr>
    </table>
</div>
</body>
</html>